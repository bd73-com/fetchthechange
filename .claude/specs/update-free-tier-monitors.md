# Feature: Update Free Tier from 1 to 3 Monitors
> Specification generated by /interview on 2026-02-20
> This is a planning document. No implementation code has been written.

## Implementation Instructions
This specification is context for the implementing agent. Read and internalize it fully before writing any code.

**IMPORTANT — Do NOT:**
- Add comments referencing this spec (no `// See spec: ...`, no `// REQ-001`, no `// Don't #3`)
- Structure code around spec sections — structure it around clean domain logic
- Embed spec traceability IDs in code, comments, variable names, or test names
- Add comments explaining "why" when the code is self-documenting

**DO:**
- Write clean, idiomatic code that follows the reference implementation patterns
- Let the constraints from this spec guide your decisions silently — they should be invisible in the final code
- Name things after domain concepts, not spec concepts
- Write tests that verify behavior, named after what they verify (not after spec requirement IDs)

## Overview
Increase the free tier monitor limit from 1 to 3. All other free tier parameters remain unchanged (pricing, check frequency, email rate limits, Browserless caps, pause thresholds). Update the constant, all hardcoded marketing/support copy, the test suite, and add a temporary announcement banner on the Dashboard for existing free tier users.

## Scope
### In Scope
- Change the `TIER_LIMITS.free` constant from 1 to 3
- Update all hardcoded frontend copy referencing "1 monitor" to "3 monitors"
- Update the test assertion for `TIER_LIMITS.free`
- Add a temporary dismissible banner on the Dashboard for free tier users announcing the expanded limit, with a hardcoded cutoff date 7 days post-deploy

### Out of Scope
- Changes to Pro or Power tier limits
- Changes to email rate limits, Browserless caps, pause thresholds, or pricing
- Database migrations or schema changes
- Stripe product/price changes (the free tier has no Stripe product)
- Server-side per-user tracking of banner dismissal

### Deferred
- Potential email campaign notifying existing free users (handled separately via admin campaigns)

## Reference Implementation
- Reference: Existing tier usage display in `client/src/pages/Dashboard.tsx:114-145`
- For the banner component pattern, follow the existing Card/Badge patterns in the Dashboard

## Codebase Context
- Architecture: Express + React SPA, shared types in `shared/`
- ORM: Drizzle ORM with PostgreSQL
- API framework: Express with typed routes
- Test framework: Vitest with `expect` assertions (`shared/schema.test.ts`)
- Validation: Zod schemas in `shared/routes.ts`
- Error handling: JSON error responses with `code` field (e.g., `TIER_LIMIT_REACHED`)

## Requirements
1. Change `TIER_LIMITS.free` from `1` to `3` in `shared/models/auth.ts`
2. Update the test in `shared/schema.test.ts` that asserts `TIER_LIMITS.free` equals `1` to assert `3`
3. Update all hardcoded "1 monitor" / "1 website monitor" / "1 monitored page" strings in frontend pages to use "3 monitors" / "3 website monitors" / "3 monitored pages" (note: pluralization)
4. Add a temporary banner at the top of the Dashboard page for free tier users:
   - Message: announce that the free plan now includes 3 monitors
   - Visible only when: user is on the free tier AND current date is before the cutoff date
   - Cutoff: hardcoded date set to 7 days after deployment
   - Dismissible: user can close it (dismiss state stored in localStorage for session comfort, but the banner disappears for everyone after the cutoff date regardless)
   - After the cutoff date: the banner component simply does not render

## Prohibitions (Don'ts)
- NEVER change Pro tier limit (must remain 100)
- NEVER change Power tier limit (must remain Infinity)
- NEVER change email rate limits (1 email per 24h per monitor for free tier)
- NEVER change Browserless caps (free tier must remain 0)
- NEVER change auto-pause thresholds (free tier must remain 3 consecutive failures)
- NEVER change pricing ($0 forever for free tier)
- NEVER change check frequency (1 check per 24 hours for free tier)
- NEVER introduce database schema changes for this feature
- NEVER change server-side enforcement logic beyond what the constant change already handles

## Decision Tree
```
User visits Dashboard
├── User tier != "free"
│   └── Do NOT show banner
├── User tier == "free" AND currentDate >= cutoffDate
│   └── Do NOT show banner (expired)
└── User tier == "free" AND currentDate < cutoffDate
    ├── Banner dismissed in localStorage?
    │   └── Do NOT show banner
    └── Banner NOT dismissed
        └── SHOW banner with announcement
            └── User clicks dismiss → store in localStorage, hide banner
```

## Domain Rules & Exceptions
| Rule | Applies When | Exception | Who Can Override |
|------|-------------|-----------|-----------------|
| Free tier limit is 3 monitors | Always (post-deploy) | None | Code change only |
| Banner shows for free users | Within 7 days of deploy | Dismissed via localStorage | Self-dismissing |
| Email rate: 1/24h per monitor | Free tier users | None | Upgrade to Pro/Power |
| Browserless: 0 sessions | Free tier users | None | Upgrade to Pro/Power |

## Escalation & Guardrails
- **Fail if**: The `TIER_LIMITS.free` constant is not exactly `3` after the change
- **No retry/queue/alert logic needed**: This is a static configuration change
- **Banner guardrail**: The hardcoded cutoff date ensures the banner automatically stops appearing — no cleanup deployment needed

## Data Model
No schema changes. The `TIER_LIMITS` constant in `shared/models/auth.ts` is the only data structure affected.

## API Contract
No API changes. The existing `POST /api/monitors` endpoint already uses `TIER_LIMITS[tier]` dynamically, so it will automatically enforce the new limit of 3.

## Frontend Changes
- **Banner component**: A dismissible announcement banner at the top of the Dashboard (inline in `Dashboard.tsx` or as a small extracted component). Uses existing UI primitives (Card, Badge, Button from shadcn).
- **Copy updates across 4 files** (see Files to Modify below)

## Acceptance Criteria
### Happy Path
- [ ] Given a free tier user with 0 monitors, when they view the Dashboard, then it shows "0 / 3 monitors used"
- [ ] Given a free tier user with 2 monitors, when they try to create a third monitor, then it succeeds
- [ ] Given a free tier user with 3 monitors, when they try to create a fourth, then they receive the `TIER_LIMIT_REACHED` error
- [ ] Given the Pricing page, when a visitor views the Free plan, then it shows "3 monitors" and "3 website monitors"
- [ ] Given the Landing page, when a visitor views the Free tier card, then it shows "3 monitors" and "3 website monitors"
- [ ] Given the Support FAQ, when a visitor reads "Is there a free plan?", then it says "3 monitors"
- [ ] Given the blog posts, when a visitor reads them, then CTA text says "3 monitors" / "3 monitored pages"

### Negative / Prohibition Tests
- [ ] Given the test suite, when `TIER_LIMITS.free` is asserted, then it equals `3`
- [ ] Given a Pro tier user, when they view the Dashboard, then their limit is still 100
- [ ] Given a Power tier user, when they view the Dashboard, then their limit is still Infinity/Unlimited
- [ ] Given the constants file, then `BROWSERLESS_CAPS.free` is still `0`
- [ ] Given the constants file, then `PAUSE_THRESHOLDS.free` is still `3`

### Edge Cases
- [ ] Given a free tier user who already has 1 monitor, when the change deploys, then their Dashboard shows "1 / 3 monitors used" and they can create 2 more
- [ ] Given a free tier user visiting the Dashboard within 7 days of deploy, when they have not dismissed the banner, then the banner is visible
- [ ] Given a free tier user who dismisses the banner, when they reload, then the banner stays hidden (localStorage)
- [ ] Given any user visiting the Dashboard after the cutoff date, then no banner is rendered regardless of tier or localStorage state

### Integration / Resilience
- [ ] Given the `POST /api/monitors` endpoint, when called by a free user with < 3 monitors, then it allows creation (no code change needed — auto-inherits from constant)

## Files to Create / Modify (Implementation Plan)
- Modify: `shared/models/auth.ts` — Change `TIER_LIMITS.free` from `1` to `3`
- Modify: `shared/schema.test.ts` — Update assertion from `toBe(1)` to `toBe(3)`, update test description
- Modify: `client/src/pages/Pricing.tsx` — Change "1 monitor" to "3 monitors" and "1 website monitor" to "3 website monitors" in the Free plan object
- Modify: `client/src/pages/LandingPage.tsx` — Change "1 monitor" to "3 monitors" and "1 website monitor" to "3 website monitors" in the Free tier card
- Modify: `client/src/pages/Support.tsx` — Change "1 monitor" to "3 monitors" in the FAQ answer
- Modify: `client/src/pages/BlogComparison.tsx` — Change "1 monitor" to "3 monitors" in pricing FAQ and CTA
- Modify: `client/src/pages/BlogWhyMonitorsFail.tsx` — Change "1 monitored page" to "3 monitored pages" in CTA
- Modify: `client/src/pages/Dashboard.tsx` — Add temporary announcement banner for free tier users with hardcoded cutoff date and localStorage-based dismiss

## Observability
- No new logging, metrics, or alerting needed for this change
- The existing `TIER_LIMIT_REACHED` error response already includes the limit value, which will automatically show `3`
- Never log: user email, session tokens (existing policy)

## Key Decisions Made
| Decision | Options Considered | Chosen | Rationale |
|----------|-------------------|--------|-----------|
| Copy wording | "3 website monitors" vs "Up to 3 website monitors" | "3 website monitors" | Matches the pattern used by Pro ("100 website monitors") and Power ("Unlimited website monitors") |
| Email rate limit | Keep 1/24h per monitor vs change | Keep unchanged | Developer confirmed all other parameters unchanged |
| Browserless cap | Keep at 0 vs grant some | Keep at 0 | Developer confirmed all other parameters unchanged |
| Existing user notification | Dashboard display only vs banner | Temporary banner | Developer requested a banner that disappears after 7 days |
| Banner expiry mechanism | Hardcoded cutoff date vs localStorage timestamp vs server-side flag | Hardcoded cutoff date | No per-user state needed, self-cleaning, no schema changes |
| Banner location | Top of Dashboard vs inline vs toast | Top of Dashboard | Standard SaaS announcement pattern |

## Open Questions
None — all decisions have been made.
